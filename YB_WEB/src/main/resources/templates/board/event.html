<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8">
<title>이벤트 - YB WEB</title>

    <!-- 폰트 -->
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700;900&display=swap" rel="stylesheet">

    <!-- 공통 레이아웃 CSS -->
    <link rel="stylesheet" th:href="@{/css/layout/header.css}">
    <link rel="stylesheet" th:href="@{/css/layout/footer.css}">

    <!-- 이벤트 전용 CSS -->
    <link rel="stylesheet" th:href="@{/css/board/event.css}">
</head>
<body class="board-page">

<div class="page">

    <!-- 공통 헤더 -->
    <th:block th:replace="layout/header :: header"></th:block>

    <!-- 메인 영역 -->
    <main class="board-main">

        <!-- 상단 타이틀 영역 -->
        <section class="board-header">
            <div class="board-header-inner">
                <div class="board-title-wrap">
                    <p class="breadcrumb">새소식 &gt; 이벤트</p>
                    <h1>이벤트 안내</h1>
                    <p class="board-desc">
                        YB WEB에서 진행 중인 다양한 웹 / 인게임 / PC방 이벤트를 확인해 보세요.
                    </p>
                </div>

                <!-- 우측 정렬(필요하면 탭/버튼 추가 가능) -->
                <div class="board-header-side">
                    <span class="header-label">EVENT CENTER</span>
                </div>
            </div>
        </section>

        <!-- 필터 / 검색 영역 -->
        <section class="event-toolbar-section">
            <div class="event-toolbar-inner">

                <div class="event-count">
                    총 <span th:text="${#lists.size(events)}">0</span>개의 이벤트가 있습니다.
                </div>

                <div class="event-filters">
                    <!-- 상단 상태 필터 (더미, 나중에 form 처리 가능) -->
                    <div class="filter-tabs">
                        <button class="active" type="button">전체</button>
                        <button type="button">진행 중</button>
                        <button type="button">예정</button>
                        <button type="button">종료</button>
                    </div>

                    <!-- 정렬/검색 (필요하면 실제 form으로 바꿔도 됨) -->
                    <form class="event-search" method="get">
                        <select name="sort">
                            <option value="latest">최신순</option>
                            <option value="end">종료 임박순</option>
                        </select>
                        <input type="text" name="keyword" placeholder="이벤트 제목 검색">
                        <button type="submit">검색</button>
                    </form>
                    
                    <!-- ★ 이벤트 등록 버튼 -->
    				<a th:href="@{/event/write}" class="btn-write">이벤트 등록</a>
                </div>

            </div>
        </section>

        <!-- 이벤트 카드 리스트 -->
        <section class="event-list-section">
            <div class="board-inner">

                <div class="event-grid">

    <!-- ★ DB 이벤트 카드 반복 -->
    <article class="event-card"
         th:each="event : ${events}"
         th:classappend="
            ' ' +
            (${event.status} == 'OPEN' ? 'status-open' :
                (${event.status} == 'UPCOMING' ? 'status-upcoming' : 'status-closed')) +
            ' ' +
            (${event.category} == 'WEB' ? 'type-web' :
                (${event.category} == 'INGAME' ? 'type-ingame' :
                (${event.category} == 'PC' ? 'type-pc' : 'type-event')))
         ">

        <!-- 썸네일 -->
        <div class="event-thumb"
             th:style="${event.thumbnailUrl} != null ? 'background-image:url(' + event.thumbnailUrl + ');' : null">
            <!-- D-day 표시 (endDate 있을 때만) -->
            <span class="d-day"
                  th:if="${event.endDate != null}"
                  th:text="'D-' + ${T(java.time.temporal.ChronoUnit).DAYS.between(T(java.time.LocalDate).now(), event.endDate)}">
                D-5
            </span>
            <span class="d-day end"
                  th:if="${event.endDate != null and T(java.time.LocalDate).now().isAfter(event.endDate)}">
                종료
            </span>
        </div>

        <div class="event-body">

            <!-- 상태/카테고리 뱃지 -->
            <div class="event-top">
                <span class="badge badge-status"
                      th:classappend="${event.status} == 'OPEN' ? ' open' :
                                      (${event.status} == 'UPCOMING' ? ' upcoming' : ' closed')"
                      th:text="${event.status} == 'OPEN' ? '진행 중' :
                               (${event.status} == 'UPCOMING' ? '진행 예정' : '종료')">
                    진행 중
                </span>

                <span class="badge badge-type"
                      th:classappend="${event.category} == 'WEB' ? ' web' :
                                      (${event.category} == 'INGAME' ? ' ingame' :
                                      (${event.category} == 'PC' ? ' pc' : ' event'))"
                      th:text="${event.category} == 'WEB' ? '웹 이벤트' :
                               (${event.category} == 'INGAME' ? '인게임 이벤트' :
                               (${event.category} == 'PC' ? 'PC방 이벤트' : '커뮤니티 이벤트'))">
                    웹 이벤트
                </span>
            </div>

            <!-- 제목 -->
            <h2 class="event-title"
                th:text="${event.title}">
                이벤트 제목
            </h2>

            <!-- 내용 요약 -->
            <p class="event-desc"
    th:text="${#strings.isEmpty(event.content) ? '' 
               : (#strings.length(event.content) > 80 
                    ? event.content.substring(0,80) + '...' 
                    : event.content)}">
    설명 80자 미리보기
</p>

            <!-- 기간 / 플랫폼 -->
            <div class="event-meta">
                <span class="period"
                      th:if="${event.startDate != null and event.endDate != null}"
                      th:text="${#temporals.format(event.startDate, 'yyyy.MM.dd')} + ' ~ ' +
                               ${#temporals.format(event.endDate, 'yyyy.MM.dd')}">
                    2025.12.01 ~ 2025.12.31
                </span>
                <span class="period"
                      th:if="${event.startDate == null or event.endDate == null}">
                    상시 진행
                </span>

                <span class="platform"
                      th:text="'플랫폼 : ' + (${event.platform} != null ? event.platform : '기타')">
                    플랫폼 : PC / 모바일
                </span>
            </div>

            <!-- 상세보기 -->
            <div class="event-actions"><a th:href="@{|/event/${event.id}|}" class="btn-detail">이벤트 상세 보기</a></div>
        </div>
    </article>

</div>

                <!-- 페이징 (더미) -->
                <div class="pagination">
                    <button class="page-btn prev" type="button">&lt;</button>
                    <button class="page-btn active" type="button">1</button>
                    <button class="page-btn" type="button">2</button>
                    <button class="page-btn" type="button">3</button>
                    <button class="page-btn next" type="button">&gt;</button>
                </div>

            </div>
        </section>

    </main>

    <!-- 공통 푸터 -->
    <th:block th:replace="layout/footer :: footer"></th:block>

</div>

</body>
</html>